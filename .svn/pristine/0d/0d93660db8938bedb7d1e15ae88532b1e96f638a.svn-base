package flow;

import com.avaya.sce.runtime.tracking.TraceInfo;
import com.avaya.sce.runtimecommon.ITraceInfo;
import com.avaya.sce.runtimecommon.SCESession;
import com.rcom.Data.utils.Constants;
import com.servion.util.AppProperties;

/**
 * A basic servlet which allows a user to define custom VXML code
 * Last generated by Orchestration Designer at: 2017-FEB-27  11:40:37 AM
 */
public class confirmUserChoice extends com.avaya.sce.runtime.MLServlet {

	//{{START:CLASS:FIELDS
	//}}END:CLASS:FIELDS

	/**
	 * Default constructor
	 * Last generated by Orchestration Designer at: 2017-FEB-27  11:40:37 AM
	 */
	public confirmUserChoice() {
		//{{START:CLASS:CONSTRUCTOR
		super();
		//}}END:CLASS:CONSTRUCTOR
	}

	/**
	 * This method allows for custom VXML development.
	 * This method is invoked after the application document is started and the
	 * form is started (<vxml> and <form> for vxml).  Here you can generate markup language,
	 * and alter the Submit object by adding additional items to submit and changing whether 
	 * the submit does a get or post.  After this method completes the Submit is generated and 
	 * the form is ended and the application document is ended (</form> and </vxml> for vxml).
	 * There is no need to invoke the super implementation when overriding this method.
	 * 
	 * You may want to check the user agent in the HTTP request header to determine whether
	 * to generate HTML or VXML.
	 * 
	 * @param out Print Stream that markup language should be written to.
	 * @param submit The submit object.  You can add items to the submit list and change wether it is a get or post.
	 * @param mySession the session object which allows access to all session variables.
	 *
	 * The code generator will *** NOT *** overwrite this method in the future.
	 * Last generated by Orchestration Designer at: 2017-FEB-27  11:40:37 AM
	 */
	public void markupLanguageGeneration(java.io.PrintStream out, com.avaya.sce.runtime.Submit submit, com.avaya.sce.runtimecommon.SCESession mySession) {

		String hostResult = Constants.Success;
		String fetchTimeOut = "10s";
		fetchTimeOut = AppProperties.GetInstance(Constants.IVR_CONFIG).getIVRProp(Constants.FETCH_TIMEOUT).trim();

		if(fetchTimeOut!=null){
			if(fetchTimeOut.equalsIgnoreCase(Constants.EMPTY_STRING)||fetchTimeOut.equalsIgnoreCase("'N'")||!fetchTimeOut.contains("s"))
				fetchTimeOut =Constants.TEN;
		}
		try{
					
				out.println("<var name=\"confirmUserChoice___CCGResponse\"/> ");
				out.println("<var name=\"mdn\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_ANI).getStringValue()+"'\"/>");
				out.println("<var name=\"productid\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_PRODUCTID).getStringValue()+"'\"/>");
				out.println("<var name=\"pprice\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_PRICE).getStringValue()+"'\"/>");
				out.println("<var name=\"pdesc\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_PRODUCTID).getStringValue()+"'\"/>");
				out.println("<var name=\"pvalidity\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_VALIDITY).getStringValue()+"'\"/>");
				out.println("<var name=\"userid\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_USERID).getStringValue()+"'\"/>");
				out.println("<var name=\"password\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_PASSWORD).getStringValue()+"'\"/>");
				out.println("<var name=\"channelid\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_CHANNELID).getStringValue()+"'\"/>");
				out.println("<var name=\"type\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_TYPE).getStringValue()+"'\"/>");
				//out.println("<var name=\"transid\" expr=\"'1121223442434376'\"/>");
				out.println("<var name=\"transid\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_TRANSID).getStringValue()+"'\"/>");
				out.println("<var name=\"contentid\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_CONTENTID).getStringValue()+"'\"/>");
				out.println("<var name=\"cpid\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_CPID).getStringValue()+"'\"/>");
				out.println("<var name=\"action\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_ACTION).getStringValue()+"'\"/>");
				out.println("<var name=\"appid\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_PRODUCTID).getStringValue()+"'\"/>");
				out.println("<var name=\"pname\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_PNAME).getStringValue()+"'\"/>");
				out.println("<var name=\"language\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_LANGUAGE).getStringValue()+"'\"/>");
				out.println("<var name=\"Ivr_approach\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_IVR__APPROACH).getStringValue()+"'\"/>");
				out.println("<var name=\"ipmode\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_IPMODE).getStringValue()+"'\"/>");
				out.println("<var name=\"cburl\" expr=\"'"+mySession.getVariableField(IProjectVariables.APP_VARIABLES, IProjectVariables.APP_VARIABLES_FIELD_CBURL).getStringValue()+"'\"/>");
				out.println("<subdialog name=\"confirmUserChoice\" src=\"http://10.185.16.4:9091/API/CCG?\" method=\"get\" namelist=\"mdn productid pprice pdesc pvalidity userid password channelid type transid contentid cpid action appid pname language Ivr_approach ipmode cburl\">");
				out.println("<filled> ");
				out.println("<assign name=\"confirmUserChoice___CCGResponse\" expr=\"confirmUserChoice.CCGResponse\"/>");
				out.println("<log>specified value1 is  <value expr=\"confirmUserChoice.CCGResponse\"/></log>");
				out.println("<log>specified value2 is  <value expr=\"confirmUserChoice___CCGResponse\"/></log>");
				out.println("</filled>");
				out.println("</subdialog>");
				out.println("<block>") ;
				out.println("<submit next=\"ResponC\" namelist =\"confirmUserChoice___CCGResponse\" method =\"post\" fetchtimeout =\""+fetchTimeOut+"\"/>"); 
				out.println("</block>");
				
				TraceInfo.trace(ITraceInfo.TRACE_LEVEL_INFO, "ConfirmUserChoice.CCGResponse: "+mySession.getVariableField(IProjectVariables.CONFIRM_USER_CHOICE, IProjectVariables.CONFIRM_USER_CHOICE_FIELD_CCGRESPONSE).getStringValue(),mySession);
		
				//System.out.println(mySession.getVariableField
	}
	catch(Exception e)
	{
		TraceInfo.trace(ITraceInfo.TRACE_LEVEL_INFO, "Exception in confirmUserChoice : "+e,mySession);
		hostResult = Constants.ERROR;
	}
		
	finally{
		
		mySession.getVariableField(IProjectVariables.APP_VARIABLES,IProjectVariables.APP_VARIABLES_FIELD_HOST_RESULT).setValue(hostResult);
	}
		super.markupLanguageGeneration(out, submit, mySession); 
		


	}
	/**
	 * Returns the submit item that identifies the next form to transition to.
	 * This method is generated automatically by the code generator
	 * and should not be manually edited.  Manual edits may be overwritten
	 * by the code generator.
	 * Last generated by Orchestration Designer at: 2017-AUG-19  04:57:49 PM
	 */
	public com.avaya.sce.runtime.Submit getSubmit(com.avaya.sce.runtimecommon.SCESession mySession) {
		com.avaya.sce.runtime.Submit submit = null;
		submit = new com.avaya.sce.runtime.Submit("ResponC");
		return submit;
	}

	
	
	
}
